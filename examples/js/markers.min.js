$(document).ready(function(){var b;var d=function(){var n=$("#map");n.height($(window).height()-$("div.navbar").outerHeight());if(b){b.invalidateSize()}};$(window).on("resize",function(){d()});d();b=L.map("map").setView([-4,13],6);var l=new L.StamenTileLayer("toner",{detectRetina:true});l.addTo(b);var c=L.control.layers({"Stamen Toner":l}).addTo(b);var i;var j;var g=function(n){var o=new L.LayerGroup();b.addLayer(o);c.addOverlay(o,n);return o};var f=function(n,t,u,p,s,q,v){var w=g(n);var o=new L.Callout(new L.LatLng(t,u),{direction:L.CalloutLine.DIRECTION.NW,lineStyle:L.CalloutLine.LINESTYLE.STRAIGHT,numberOfSides:3,arrow:true,color:"#C0C0C0",fillColor:"#C0C0C0",position:new L.Point(-60,0),size:new L.Point(40,0),icon:new L.DivIcon({iconSize:new L.Point(80,50),html:"<div>"+n+"</div>",className:"callout-text"})});w.addLayer(o);for(var r=0;r<s;++r){w.addLayer(q(new L.LatLng(t,u+r*p),r))}};f("Regular Polygons",0,0,2,5,function(r,q){var p=q*20;var o={color:"#000",weight:1,fillColor:"hsl("+p+",100%,50%)",radius:30,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,numberOfSides:q+3};o.rotation=(o.numberOfSides%2===0?180:90)/o.numberOfSides;o.imageCircleUrl="http://upload.wikimedia.org/wikipedia/commons/6/68/Ambulance_font_awesome.svg";var n=new L.RegularPolygonMarker(r,o);n.on("mousedown",function(t){var s=function(u){n.setLatLng(u.latlng)};b.on("mousemove",s);b.on("mouseup",function(u){b.off("mousemove",s)});n.on("mouseup",function(u){b.off("mousemove",s)})});return n});f("Regular Polygons (Hollow)",-2,0,2,5,function(q,p){var o=Math.random()*360;var n={color:"#000",weight:1,fillColor:"hsl("+o+",100%,50%)",radius:Math.random()*40+10,fillOpacity:0.7,rotation:Math.random()*360,position:{x:0,y:0},offset:0,numberOfSides:p+3};n.innerRadius=n.radius/2;return new L.RegularPolygonMarker(q,n)});f("Stars",-4,0,2,5,function(r,q){var p=Math.random()*360;var o={color:"#000",weight:1,fillColor:"hsl("+p+",100%,50%)",radius:Math.random()*40+10,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,rotation:Math.random()*360,numberOfPoints:q+5};o.innerRadius=o.radius/2;var n=new L.StarMarker(r,o);return n});f("Custom SVG",-10,0,2,5,function(p,t){var n=Math.random()*360;var v={color:"#000",weight:1,fillColor:"hsl("+n+",100%,50%)",radius:Math.random()*40+10,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,rotation:Math.random()*360,numberOfPoints:t+5,clickable:true};v.innerRadius=v.radius/2;v.svg="http://upload.wikimedia.org/wikipedia/commons/8/8b/Green_Arrow_Up_Darker.svg";var o=Math.max(40,Math.random()*100);v.size=new L.Point(o,o);var w=new L.HSLHueFunction([0,0],[5,330]);var r=w.random();v.setStyle=function(x){$(x).find("path").css("fill",r)};var s=new L.SVGMarker(p,v);var q=0;var u=function(x){L.Util.requestAnimFrame(u);q=q+2%360;s.setStyle({rotation:q});s.redraw()};setTimeout(u,1000/60);s.bindPopup("Test");return s});f("Custom SVG",-12,0,2,5,function(q,t){var n=Math.random()*360;var u={color:"#000",weight:1,fillColor:"hsl("+n+",100%,50%)",radius:Math.random()*40+10,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,numberOfPoints:t+5,clickable:true};u.innerRadius=u.radius/2;u.svg="http://upload.wikimedia.org/wikipedia/commons/0/05/Robot_icon.svg";var o=Math.max(40,Math.random()*100);u.size=new L.Point(o,o);var v=new L.HSLHueFunction([0,0],[5,330]);var r=v.random();var p=function(w){return function(x){$(x).find("rect").css("fill",w)}};u.setStyle=p(r);var s=new L.SVGMarker(q,u);s.on("click",function(){if(s.options.oldStyle){s.options.setStyle=s.options.oldStyle;s.redraw();s.options.oldStyle=null}else{s.options.oldStyle=s.options.setStyle;s.options.setStyle=function(w){var x=$(w).find("path:first");x.attr("transform",x.attr("transform")+" scale(1.2,1.2)")};s.redraw()}});return s});f("Map Markers",-6,0,2,5,function(r,p){var o=Math.random()*360;var n={color:"#000",weight:1,fillColor:"hsl("+o+",100%,50%)",fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,radius:(Math.random()*30)+5,innerRadius:0};var q=["http://upload.wikimedia.org/wikipedia/commons/6/62/Food_font_awesome.svg","http://upload.wikimedia.org/wikipedia/commons/5/57/Light_bulb_font_awesome.svg","http://upload.wikimedia.org/wikipedia/commons/4/48/Flag_font_awesome.svg","http://upload.wikimedia.org/wikipedia/commons/6/64/Plane_font_awesome.svg","http://upload.wikimedia.org/wikipedia/commons/1/15/Leaf_font_awesome.svg"];n.imageCircleUrl=q[p];return new L.MapMarker(r,n)});f("Radial Meter Markers",-8,0,2,5,function(r,o){var p=120;var n=0;var q={data:{Speed:Math.random()*200},chartOptions:{Speed:{displayName:"Speed",displayText:function(s){return s.toFixed(1)},color:"hsl(240,100%,55%)",fillColor:"hsl(240,80%,55%)",maxValue:200,minValue:0}},displayOptions:{Speed:{color:new L.HSLHueFunction(new L.Point(0,p),new L.Point(200,n),{outputSaturation:"100%",outputLuminosity:"25%"}),fillColor:new L.HSLHueFunction(new L.Point(0,p),new L.Point(200,n),{outputSaturation:"100%",outputLuminosity:"50%"})}},fillOpacity:0.8,opacity:1,weight:0.5,radius:30,barThickness:15,maxDegrees:360,rotation:0,numSegments:10};return new L.RadialMeterMarker(r,q)});f("Bar Charts",0,14,2,5,function(r){var o=Math.random()*360;var n={color:"#000",weight:1,fillColor:"hsl("+o+",100%,50%)",radius:20,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,width:8};n.data={dataPoint1:Math.random()*20,dataPoint2:Math.random()*20,dataPoint3:Math.random()*20,dataPoint4:Math.random()*20};n.chartOptions={dataPoint1:{fillColor:"#F2F0F7",minValue:0,maxValue:20,maxHeight:30,displayText:function(s){return s.toFixed(2)}},dataPoint2:{fillColor:"#CBC9E2",minValue:0,maxValue:20,maxHeight:30,displayText:function(s){return s.toFixed(2)}},dataPoint3:{fillColor:"#9E9AC8",minValue:0,maxValue:20,maxHeight:30,displayText:function(s){return s.toFixed(2)}},dataPoint4:{fillColor:"#6A51A3",minValue:0,maxValue:20,maxHeight:30,displayText:function(s){return s.toFixed(2)}}};var p=new L.BarChartMarker(r,n);var q=function(){p.options.data={dataPoint1:Math.random()*20,dataPoint2:Math.random()*20,dataPoint3:Math.random()*20,dataPoint4:Math.random()*20};p.redraw()};return p});f("Pie Charts",-2,14,2,5,function(p){var o=Math.random()*360;var n={color:"#000",weight:1,fillColor:"hsl("+o+",100%,50%)",radius:20,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,numberOfSides:50,barThickness:10};n.data={dataPoint1:Math.random()*20,dataPoint2:Math.random()*20,dataPoint3:Math.random()*20,dataPoint4:Math.random()*20};n.chartOptions={dataPoint1:{fillColor:"#F1EEF6",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint2:{fillColor:"#BDC9E1",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint3:{fillColor:"#74A9CF",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint4:{fillColor:"#0570B0",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}}};return new L.PieChartMarker(p,n)});f("Coxcomb Charts",-4,14,2,5,function(p){var o=Math.random()*360;var n={color:"#000",weight:1,fillColor:"hsl("+o+",100%,50%)",radius:30,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,numberOfSides:50,width:10};n.data={dataPoint1:Math.random()*20,dataPoint2:Math.random()*20,dataPoint3:Math.random()*20,dataPoint4:Math.random()*20};n.chartOptions={dataPoint1:{fillColor:"#EDF8FB",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint2:{fillColor:"#B2E2E2",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint3:{fillColor:"#66C2A4",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint4:{fillColor:"#238B45",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}}};return new L.CoxcombChartMarker(p,n)});f("Radial Bar Charts",-6,14,2,5,function(p){var o=Math.random()*360;var n={color:"#000",weight:1,fillColor:"hsl("+o+",100%,50%)",radius:20,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,numberOfSides:50,width:10};n.data={dataPoint1:Math.random()*20,dataPoint2:Math.random()*20,dataPoint3:Math.random()*20,dataPoint4:Math.random()*20};n.chartOptions={dataPoint1:{fillColor:"#FEE5D9",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint2:{fillColor:"#FCAE91",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint3:{fillColor:"#FB6A4A",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dataPoint4:{fillColor:"#CB181D",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}}};return new L.RadialBarChartMarker(p,n)});f("Stacked Regular Polygons",-8,14,2,5,function(q,n){var p={chartOptions:{dataPoint4:{fillColor:"rgb(255, 255, 212)",minValue:0,maxValue:20,maxRadius:20,displayText:function(r){return r.toFixed(2)}},dataPoint3:{fillColor:"rgb(254, 217, 142)",minValue:0,maxValue:20,maxRadius:20,displayText:function(r){return r.toFixed(2)}},dataPoint2:{fillColor:"rgb(254, 153, 41)",minValue:0,maxValue:20,maxRadius:20,displayText:function(r){return r.toFixed(2)}},dataPoint1:{fillColor:"rgb(204, 76, 2)",minValue:0,maxValue:20,maxRadius:20,displayText:function(r){return r.toFixed(2)}}},data:{dataPoint1:5,dataPoint2:3,dataPoint3:8,dataPoint4:15},color:"#000000",weight:1,numberOfSides:6,rotation:0};p.data={};for(var o=1;o<=4;++o){p.data["dataPoint"+o]=Math.random()*20}return new L.StackedRegularPolygonMarker(q,p)});f("Stacked Pie Charts",-10,14,2,5,function(p){var o=Math.random()*360;var n={color:"#000",weight:0.5,stroke:true,fillColor:"white",fillColors:["#00FF00","#FFFF00","#FF0000","transparent"],values:[2,4,3,5],barThickness:40,fillOpacity:0.7,rotation:0,position:{x:0,y:0},offset:0,numberOfSides:50};n.data={dp1:[5,5,5.1,10],dp2:[Math.random()*20,Math.random()*20,Math.random()*20,Math.random()*20],dp3:[Math.random()*20,Math.random()*20,Math.random()*20,Math.random()*20],dp4:[Math.random()*20,Math.random()*20,Math.random()*20,Math.random()*20]};n.chartOptions={dp1:{fillColor:"#F1EEF6",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dp2:{fillColor:"#BDC9E1",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dp3:{fillColor:"#74A9CF",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}},dp4:{fillColor:"#0570B0",minValue:0,maxValue:20,maxHeight:20,displayText:function(q){return q.toFixed(2)}}};return new L.StackedPieChartMarker(p,n)});var k=Object.keys(L.CalloutLine.DIRECTION);console.log(k);var m=Object.keys(L.CalloutLine.LINESTYLE);var h=[5,-5,5,-5];var e=[-5,-5,5,5];var a=function(n){return function(q,o){var p=k[o%k.length];return new L.Callout(q,{direction:L.CalloutLine.DIRECTION[p],lineStyle:L.CalloutLine.LINESTYLE[n],numberOfSides:3,arrow:true,color:"#C0C0C0",fillColor:"#C0C0C0",position:new L.Point(h[o],e[o]),size:new L.Point(40,40),icon:new L.DivIcon({iconSize:new L.Point(28,14),html:p.toUpperCase(),className:"callout-text"}),dropShadow:false})}};f("Callouts (Arced)",-1,28,0,4,a(m[0]));f("Callouts (Angled)",-4,28,0,4,a(m[1]));f("Callouts (Straight)",-7,28,0,4,a(m[2]))});