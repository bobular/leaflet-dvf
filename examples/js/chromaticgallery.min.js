var linearPartition,_this=this;linearPartition=function(t,f){var r,l,h,c,a,o,s,q,p,g,e,d,b;a=t.length;if(f<=0){return[]}if(f>a){return t.map(function(i){return[i]})}s=(function(){var j,i;i=[];for(p=j=0;0<=a?j<a:j>a;p=0<=a?++j:--j){i.push((function(){var m,k;k=[];for(q=m=0;0<=f?m<f:m>f;q=0<=f?++m:--m){k.push(0)}return k})())}return i})();o=(function(){var k,j,i;i=[];for(p=k=0,j=a-1;0<=j?k<j:k>j;p=0<=j?++k:--k){i.push((function(){var u,m,n;n=[];for(q=u=0,m=f-1;0<=m?u<m:u>m;q=0<=m?++u:--u){n.push(0)}return n})())}return i})();for(l=g=0;0<=a?g<a:g>a;l=0<=a?++g:--g){s[l][0]=t[l]+(l?s[l-1][0]:0)}for(h=e=0;0<=f?e<f:e>f;h=0<=f?++e:--e){s[0][h]=t[0]}for(l=d=1;1<=a?d<a:d>a;l=1<=a?++d:--d){for(h=b=1;1<=f?b<f:b>f;h=1<=f?++b:--b){c=_.min((function(){var j,i;i=[];for(q=j=0;0<=l?j<l:j>l;q=0<=l?++j:--j){i.push([_.max([s[q][h-1],s[l][0]-s[q][0]]),q])}return i})(),function(i){return i[0]});s[l][h]=c[0];o[l-1][h-1]=c[1]}}a=a-1;f=f-2;r=[];while(f>=0){r=[(function(){var k,m,i,j;j=[];for(l=k=m=o[a-1][f]+1,i=a+1;m<=i?k<i:k>i;l=m<=i?++k:--k){j.push(t[l])}return j})()].concat(r);a=o[a-1][f];f=f-1}return[(function(){var j,k,i;i=[];for(l=j=0,k=a+1;0<=k?j<k:j>k;l=0<=k?++j:--j){i.push(t[l])}return i})()].concat(r)};var layoutPhotos=function(b,l,a,c){var g,f,h,d,m,j,e,i;var k=$(b);e=k.width();g=parseInt(k.height()/3);j=_.reduce(l,function(n,o){return n+=a(o)*g},0);m=Math.round(j/e);if(m<1){_.each(l,function(n){return c(n,parseInt(g*a(n)),g)})}else{i=_.map(l,function(n){return parseInt(a(n)*100)});h=linearPartition(i,m);f=0;_.each(h,function(o){var n;d=[];_.each(o,function(){var p=l[f++];d.push(p);return p});n=_.reduce(d,function(q,r){return q+=a(r)},0);return _.each(d,function(p){return c(p,parseInt(e/n*a(p)),parseInt(e/n))})})}k.empty();_.each(l,function(n){$(_.template('<img src="<%= photo_file_url %>" width="<%= width %>" height="<%= height %>"/>',n)).hide().appendTo(k).fadeIn("slow")})};